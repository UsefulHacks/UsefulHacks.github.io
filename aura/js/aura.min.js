function openNav(){document.getElementById("mySidenav").style.width="94px"}function closeNav(){document.getElementById("mySidenav").style.width="0"}function toggleVideoSelect(){const e=document.getElementById("videoSelect");"block"==e.style.display?e.style.display="none":e.style.display="block"}window.addEventListener("load",e=>{document.getElementById("sidenavOpenBtn").addEventListener("click",openNav),document.getElementById("sidenavCloseBtn").addEventListener("click",closeNav),document.getElementById("videoSelectBtn").addEventListener("click",toggleVideoSelect)});let mediaElement,audioInputSelect,audioOutputSelect,videoSelect,selectors;function gotDevices(t){const n=selectors.map(e=>e.value);selectors.forEach(e=>{for(;e.firstChild;)e.removeChild(e.firstChild)});for(let e=0;e!==t.length;++e){var o=t[e];const i=document.createElement("option");i.value=o.deviceId,audioInputSelect&&"audioinput"===o.kind?(i.text=o.label||`microphone ${audioInputSelect.length+1}`,audioInputSelect.appendChild(i)):audioOutputSelect&&"audiooutput"===o.kind?(i.text=o.label||`speaker ${audioOutputSelect.length+1}`,audioOutputSelect.appendChild(i)):videoSelect&&"videoinput"===o.kind&&(i.text=o.label||`camera ${videoSelect.length+1}`,videoSelect.appendChild(i))}selectors.forEach((e,t)=>{Array.prototype.slice.call(e.childNodes).some(e=>e.value===n[t])&&(e.value=n[t])})}function attachSinkId(e,t){void 0!==e.sinkId?e.setSinkId(t).then(()=>{console.log(`Success, audio output device attached: ${t}`)}).catch(e=>{let t=e;"SecurityError"===e.name&&(t=`You need to use HTTPS for selecting audio output device: ${e}`),console.error(t),audioOutputSelect.selectedIndex=0}):console.warn("Browser does not support output device selection.")}function changeAudioDestination(){var e=audioOutputSelect.value;attachSinkId(mediaElement,e)}function gotStream(e){return mediaElement.srcObject=e,navigator.mediaDevices.enumerateDevices()}function handleError(e){console.log("navigator.MediaDevices error: ",e.message,e.name)}function mediaDevicesAllTracksStopped(){const e=mediaElement.srcObject;let t=!0;if(e){console.log("mediaDevicesStop()");const n=e.getTracks();n.forEach(e=>{"ended"!==e.readyState&&(t=!1)})}return t}function mediaDevicesStop(){const e=mediaElement.srcObject;if(e){console.log("mediaDevicesStop()");const t=e.getTracks();t.forEach(e=>e.stop())}else console.warn("mediaDevicesStop(): no tracks to stop")}function mediaDevicesStart(){console.log("mediaDevicesStart()"),mediaDevicesStop();var e=audioInputSelect?audioInputSelect.value:null,t=videoSelect?videoSelect.value:null;return navigator.mediaDevices.getUserMedia({audio:{deviceId:e?{exact:e}:void 0},video:{facingMode:"environment",deviceId:t?{exact:t}:void 0}}).then(gotStream).then(gotDevices)}const mediaDevicesInit=async e=>{console.log("mediaDevicesInit()"),"undefined"==mediaElement&&await navigator.mediaDevices.getUserMedia({audio:!!e.audioInputSelect||!!e.audioOutputSelect,video:!!e.videoSelect}),mediaElement=e.mediaElement,audioInputSelect=e.audioInputSelect,audioOutputSelect=e.audioOutputSelect,videoSelect=e.videoSelect,selectors=[],[audioInputSelect,audioOutputSelect,videoSelect].forEach(e=>{e&&selectors.push(e)}),audioInputSelect&&(audioInputSelect.onchange=mediaDevicesStart),audioOutputSelect&&(audioOutputSelect.disabled=!("sinkId"in HTMLMediaElement.prototype)),audioOutputSelect&&(audioOutputSelect.onchange=changeAudioDestination),videoSelect&&(videoSelect.onchange=mediaDevicesStart),await navigator.mediaDevices.enumerateDevices().then(gotDevices).then(mediaDevicesStart).catch(handleError)};mediaDevicesInit({mediaElement:document.querySelector("video"),audioInputSelect:null,audioOutputSelect:null,videoSelect:document.querySelector("select#videoSelect")});const msToSmpteString=(e,t=30)=>{var n=e/36e5,o=Math.floor(n),i=60*(n-o),e=Math.floor(i),n=60*(i-e),i=Math.floor(n),t=Math.floor((n-i)*t);return`${o<10?"0":""}${o}:${e<10?"0":""}${e}:${n<10?"0":""}${i};${t<10?"0":""}${t}`},msToSmpteStringhhmmss=(e,t=0)=>{var n=e/36e5,o=Math.floor(n),e=60*(n-o),n=Math.floor(e),e=60*(e-n);return`${o<10?"0":""}${o}:${n<10?"0":""}${n}:${e<10?"0":""}${Math.floor(e)}`},triangles=[{x1:330,y1:140,x2:300,y2:140,x3:285,y3:125},{x1:240,y1:100,x2:240,y2:60,x3:250,y3:90},{x1:280,y1:110,x2:330,y2:140,x3:285,y3:125},{x1:330,y1:140,x2:290,y2:150,x3:300,y3:140},{x1:280,y1:90,x2:320,y2:80,x3:325,y3:90},{x1:280,y1:80,x2:280,y2:50,x3:320,y3:80},{x1:280,y1:90,x2:280,y2:80,x3:320,y3:80},{x1:280,y1:90,x2:325,y2:90,x3:330,y3:110},{x1:230,y1:190,x2:240,y2:170,x3:280,y3:170},{x1:240,y1:60,x2:210,y2:90,x3:240,y3:100},{x1:240,y1:60,x2:210,y2:90,x3:200,y3:70},{x1:280,y1:90,x2:330,y2:110,x3:330,y3:140},{x1:280,y1:90,x2:330,y2:110,x3:320,y3:80},{x1:280,y1:90,x2:330,y2:140,x3:280,y3:110},{x1:330,y1:140,x2:280,y2:110,x3:290,y3:150},{x1:280,y1:110,x2:280,y2:90,x3:250,y3:90},{x1:250,y1:90,x2:280,y2:110,x3:280,y3:90},{x1:290,y1:150,x2:330,y2:140,x3:280,y3:110},{x1:290,y1:150,x2:330,y2:140,x3:320,y3:170},{x1:290,y1:150,x2:320,y2:170,x3:280,y3:170},{x1:290,y1:150,x2:280,y2:170,x3:250,y3:170},{x1:280,y1:170,x2:320,y2:170,x3:270,y3:200},{x1:270,y1:200,x2:280,y2:170,x3:250,y3:200},{x1:250,y1:200,x2:280,y2:170,x3:270,y3:200},{x1:250,y1:200,x2:280,y2:170,x3:230,y3:190},{x1:230,y1:190,x2:280,y2:170,x3:250,y3:200},{x1:230,y1:190,x2:280,y2:170,x3:250,y3:170},{x1:230,y1:190,x2:250,y2:200,x3:210,y3:210},{x1:210,y1:210,x2:250,y2:200,x3:230,y3:190},{x1:210,y1:210,x2:230,y2:190,x3:190,y3:180},{x1:190,y1:180,x2:230,y2:190,x3:210,y3:210},{x1:190,y1:180,x2:230,y2:190,x3:250,y3:170},{x1:190,y1:180,x2:210,y2:210,x3:160,y3:170},{x1:250,y1:170,x2:280,y2:170,x3:290,y3:150},{x1:200,y1:70,x2:210,y2:90,x3:150,y3:70},{x1:200,y1:70,x2:210,y2:90,x3:240,y3:60},{x1:150,y1:70,x2:200,y2:70,x3:210,y3:90},{x2:200,y2:70,x3:220,y3:50,x1:240,y1:60},{x1:240,y1:100,x2:250,y2:90,x3:240,y3:60},{x1:240,y1:60,x2:240,y2:100,x3:210,y3:90},{x1:240,y1:60,x2:240,y2:100,x3:250,y3:90},{x1:240,y1:60,x2:240,y2:100,x3:210,y3:90},{x1:210,y1:90,x2:180,y2:100,x3:150,y3:70},{x1:240,y1:60,x2:200,y2:70,x3:210,y3:90},{x1:240,y1:60,x2:200,y2:70,x3:210,y3:90},{x1:210,y1:90,x2:240,y2:60,x3:240,y3:100},{x1:210,y1:90,x2:240,y2:100,x3:240,y3:60},{x1:250,y1:90,x2:240,y2:60,x3:280,y3:50},{x1:250,y1:90,x2:240,y2:60,x3:280,y3:50},{x1:280,y1:90,x2:320,y2:80,x3:280,y3:50},{x1:280,y1:50,x2:280,y2:90,x3:250,y3:90},{x1:280,y1:50,x2:280,y2:90,x3:250,y3:90},{x1:250,y1:90,x2:280,y2:50,x3:280,y3:90},{x1:280,y1:50,x2:240,y2:60,x3:250,y3:90},{x1:250,y1:90,x2:280,y2:90,x3:280,y3:50}],createScotoma=()=>{const e=document.createElement("canvas");var t=e.getContext("2d");e.width=64,e.height=64;((e,t,n,o)=>{var i=e.createRadialGradient(t+-16,n,40,t,n,64);i.addColorStop(0,"black"),i.addColorStop(1,"white");var a="left"===o?.5*Math.PI:1.5*Math.PI,o="left"===o?1.5*Math.PI:.5*Math.PI;e.arc(t,n,64,a,o),e.fillStyle=i,e.fill()})(t,16,32,"right");const n=new THREE.Texture(e);n.needsUpdate=!0;var o=new THREE.CircleGeometry(15,32,32),t=new THREE.MeshBasicMaterial({color:15658734,alphaMap:n,transparent:!0,opacity:1});const i=new THREE.Mesh(o,t);return i.position.x=-.2,i.position.z=-.01,i};let glHueOffset=0,glMaterial=null,glRenderId=null;function main(e=0){var t=document.querySelector("#webGLCanvas");const l=new THREE.WebGLRenderer({canvas:t,alpha:!0});const c=new THREE.PerspectiveCamera(75,2,.1,100);c.position.z=20,c.position.y=0,c.position.x=-3;const s=new THREE.Scene;s.background=null;{const M=new THREE.DirectionalLight(16777215,1);M.position.set(-1,2,4),s.add(M)}const n=[];const o=[];const i=[];var a=function(t,n){let o=[],i=1e6,a=-1e6,l=1e6,c=-1e6;var s=t.length;for(let e=0;e<s;e++){var r=t[e];r.x1>a&&(a=r.x1),r.x2>a&&(a=r.x2),r.x3>a&&(a=r.x3),r.y1>c&&(c=r.y1),r.y2>c&&(c=r.y2),r.y3>c&&(c=r.y3),r.x1<i&&(i=r.x1),r.x2<i&&(i=r.x2),r.x3<i&&(i=r.x3),r.y1<l&&(l=r.y1),r.y2<l&&(l=r.y2),r.y3<l&&(l=r.y3)}var d=(e,t,n)=>(e-.5*(t+n))/(.5*(n-t));for(let e=0;e<s;e++){var u=t[e];o.push(d(u.x1,i,a)*n*2*.5,d(u.y1,l,c)*n,0,d(u.x2,i,a)*n*2*.5,d(u.y2,l,c)*n,0,d(u.x3,i,a)*n*2*.5,d(u.y3,l,c)*n,0)}return o}(triangles,20);let r=0;for(let e=0;e<a.length;e+=3)n.push(a[e],a[e+1],a[e+2]),o.push(0!=e&&!(e%6),0!=e&&!(e%3)||!(e%6)),i.push(r),r++;const d=new THREE.BufferGeometry;d.setAttribute("position",new THREE.BufferAttribute(new Float32Array(n),3)),d.setAttribute("normal",new THREE.BufferAttribute(new Float32Array([]),3)),d.setAttribute("uv",new THREE.BufferAttribute(new Float32Array(o),2)),d.setIndex(i);const u=function(e,t,n){var o=(o=null,new THREE.ShaderMaterial({uniforms:{hsvOffset:{value:new THREE.Vector3(0,0,0)},texture:{value:o},uvOffset:{value:new THREE.Vector2(0,0)}},vertexShader:`
        varying vec2 vUv;
    
        void main() {
          vUv = uv;
          gl_Position = projectionMatrix * modelViewMatrix * vec4(position,1.0);
        }
      `,fragmentShader:`
      uniform vec3 hsvOffset;
      varying vec2 vUv;
        vec3 hue2rgb(float h) {
          vec3 c = vec3(h, 0.0, 0.0);
          float k = 0.1; 
          return smoothstep(0. + k, 1. - k,1. * (
                            .5 + .5 * cos((vec3(c.x) + vec3(1., 2./3., 1./3.)) * radians(360.))));
      }
      void main() {
        float alpha = (2.0-(vUv.x + vUv.y)); // 0.8;
        gl_FragColor = vec4(hue2rgb(fract(vUv.x + vUv.y + hsvOffset[0])), alpha);
      }
      `}));const i=new THREE.Mesh(e,o);return i.position.x=t,i.position.y=n,i}(d,0,0);s.add(u);const y=createScotoma(s);s.add(y);let x,m=.1;const v=1,p=.999,g=2400,f=5e-4,h=3.5;let S=0;function E(e){S++,void 0===x&&(x=e);var t=e-x;glHueOffset+=m,1<glHueOffset&&(glHueOffset=1-glHueOffset),u.material.uniforms.hsvOffset.value=[glHueOffset,0,0];var n,o,i,a=Math.pow(S*f,3);a>h&&(S=0,y.material.opacity=v),u.scale.x=u.scale.y=a,y.scale.x=y.scale.y=a,S>g&&(y.material.opacity=Math.pow(y.material.opacity*p,1.01)),n=l,o=n.domElement,i=o.clientWidth,e=o.clientHeight,(o=o.width!==i||o.height!==e)&&n.setSize(i,e,!1),o&&(o=l.domElement,c.aspect=o.clientWidth/o.clientHeight,c.updateProjectionMatrix()),S%30||(console.log(S,y.material.opacity,t,msToSmpteStringhhmmss(t)),document.getElementById("timecodeDiv").textContent=msToSmpteStringhhmmss(a/h*30*6e4)),l.render(s,c),glRenderId=requestAnimationFrame(E)}const w=()=>{const e=document.getElementById("pauseBtn");glRenderId=null!=glRenderId?(cancelAnimationFrame(glRenderId),e.innerHTML='<i class="fas fa-play"></i>',null):(e.innerHTML='<i class="fas fa-pause"></i>',requestAnimationFrame(E))},I=document.getElementById("pauseBtn");I.addEventListener("click",e=>{w(),e.preventDefault()}),window.addEventListener("keyup",e=>{var t;e.defaultPrevented||(" "!==(t=e.key||e.keyCode)&&32!=t||(e.preventDefault(),w()))});window.onresize=()=>{l.setSize(window.innerWidth,window.innerHeight),c.aspect=window.innerWidth/window.innerHeight,c.updateProjectionMatrix()},glRenderId=requestAnimationFrame(E)}const toggleVideo=()=>{const e=document.getElementById("videoMuteBtn");mediaDevicesAllTracksStopped()?(mediaDevicesStart(),e.innerHTML='<i class="fas fa-eye-slash"></i>'):(mediaDevicesStop(),e.innerHTML='<i class="fas fa-eye"></i>')},eyesBtn=document.getElementById("videoMuteBtn");eyesBtn.addEventListener("click",toggleVideo);async function openFullscreen(){const e=document.documentElement;return e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():void 0}async function closeFullscreen(){return document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():void 0}const toggleFullScreen=()=>{const e=document.getElementById("fullscreenBtn");document.fullscreenElement||document.webkitCurrentFullScreenElement||document.mozFullScreenElement?(console.log("Exiting full-screen mode"),closeFullscreen().then(()=>{e.innerHTML='<i class="fas fa-expand"></i>'}).catch(e=>{console.log(`Error attempting to exit full-screen mode: ${e.message} (${e.name})`)})):openFullscreen().then(()=>{e.innerHTML='<i class="fas fa-compress"></i>'}).catch(e=>{console.log(`Error attempting to enable full-screen mode: ${e.message} (${e.name})`)})},fullscreenBtn=document.getElementById("fullscreenBtn");fullscreenBtn.addEventListener("click",toggleFullScreen),main();export{openNav,mediaDevicesAllTracksStopped,mediaDevicesStop,mediaDevicesStart,msToSmpteString,msToSmpteStringhhmmss,triangles,createScotoma};